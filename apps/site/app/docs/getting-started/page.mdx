---
title: å¿«é€Ÿå¼€å§‹
description: å¸®åŠ©æ–°ç”¨æˆ·å¿«é€Ÿäº†è§£ MTPC å¹¶å®Œæˆç¬¬ä¸€ä¸ªç¤ºä¾‹é¡¹ç›®çš„æ­å»º
---

# å¿«é€Ÿå¼€å§‹

æœ¬æŒ‡å—å°†å¸®åŠ©ä½ åœ¨ 5 åˆ†é’Ÿå†…åˆ›å»ºç¬¬ä¸€ä¸ª MTPC åº”ç”¨ã€‚

## ä»€ä¹ˆæ˜¯ MTPCï¼Ÿ

**MTPC (Multi-Tenant Permission Core)** æ˜¯ä¸€ä¸ªä¸šåŠ¡æ— å…³ã€å¯åµŒå…¥ã€å¯ç»„åˆçš„å¤šç§Ÿæˆ·æƒé™å†…æ ¸ã€‚

### å®šä½å£°æ˜

- MTPC â‰  æƒé™ç³»ç»Ÿ
- MTPC = æƒé™ç³»ç»Ÿçš„"å†…æ ¸ä¸å¼•æ“"

### æ ¸å¿ƒä»·å€¼

- æä¾›ç»Ÿä¸€çš„å¤šç§Ÿæˆ·æƒé™æŠ½è±¡æ¨¡å‹
- é€šè¿‡ Schema / Resource å®šä¹‰ä½œä¸ºå•ä¸€äº‹å®æº
- åœ¨ç¼–è¯‘æœŸä¸å¯åŠ¨æœŸæ´¾ç”Ÿæƒé™ç ã€CRUDã€ç±»å‹ã€èœå•å…ƒæ•°æ®
- åœ¨è¿è¡ŒæœŸæä¾›ç¨³å®šçš„æƒé™åˆ¤å®šä¸æ‰©å±•ç‚¹

### é€‚ç”¨åœºæ™¯

- SaaS å¤šç§Ÿæˆ·åº”ç”¨
- ä¼ä¸šå†…éƒ¨ç®¡ç†ç³»ç»Ÿ
- B ç«¯æƒé™æ§åˆ¶ç³»ç»Ÿ
- éœ€è¦ç»†ç²’åº¦æƒé™æ§åˆ¶çš„ä»»ä½•åº”ç”¨

## å®‰è£… MTPC

### ä½¿ç”¨ npm

```bash
npm install @mtpc/core
```

### ä½¿ç”¨ pnpm

```bash
pnpm add @mtpc/core
```

### ä½¿ç”¨ yarn

```bash
yarn add @mtpc/core
```

### ä½¿ç”¨ bun

```bash
bun add @mtpc/core
```

## é¡¹ç›®ä¾èµ–é…ç½®

### TypeScript é…ç½®

ç¡®ä¿ä½ çš„ `tsconfig.json` åŒ…å«ä»¥ä¸‹é…ç½®ï¼š

```json
{
  "compilerOptions": {
    "strict": true,
    "esModuleInterop": true,
    "skipLibCheck": true,
    "moduleResolution": "bundler"
  }
}
```

### å®‰è£… Zod

MTPC ä½¿ç”¨ Zod è¿›è¡Œ Schema å®šä¹‰ï¼Œè¯·ç¡®ä¿å·²å®‰è£…ï¼š

```bash
npm install zod
```

## 5 åˆ†é’Ÿåˆ›å»ºç¬¬ä¸€ä¸ª MTPC åº”ç”¨

### æ­¥éª¤ 1ï¼šåˆå§‹åŒ–é¡¹ç›®

```bash
mkdir my-mtpc-app
cd my-mtpc-app
npm init -y
npm install @mtpc/core zod typescript
```

### æ­¥éª¤ 2ï¼šåˆ›å»ºèµ„æºå®šä¹‰

åˆ›å»º `resources.ts` æ–‡ä»¶ï¼š

```ts
import { defineResource } from '@mtpc/core'
import { z } from 'zod'

// å®šä¹‰ç”¨æˆ·èµ„æº
export const userResource = defineResource({
  name: 'user',
  schema: z.object({
    id: z.string(),
    name: z.string(),
    email: z.string().email(),
    role: z.enum(['admin', 'user', 'guest']),
  }),
  features: {
    creatable: true,
    readable: true,
    updatable: true,
    deletable: true,
    listable: true,
  },
  metadata: {
    displayName: 'ç”¨æˆ·',
    pluralName: 'ç”¨æˆ·åˆ—è¡¨',
    description: 'ç³»ç»Ÿç”¨æˆ·ç®¡ç†',
  },
})
```

### æ­¥éª¤ 3ï¼šåˆ›å»º MTPC å®ä¾‹

åˆ›å»º `mtpc.ts` æ–‡ä»¶ï¼š

```ts
import { createMTPC } from '@mtpc/core'
import { userResource } from './resources'

// åˆ›å»º MTPC å®ä¾‹
export const mtpc = createMTPC()

// æ³¨å†Œèµ„æº
mtpc.registerResource(userResource)

// åˆå§‹åŒ–
await mtpc.init()

console.log('MTPC å·²åˆå§‹åŒ–')
console.log('å·²æ³¨å†Œèµ„æº:', mtpc.listResources())
```

### æ­¥éª¤ 4ï¼šæ£€æŸ¥æƒé™

```ts
import { mtpc } from './mtpc'

// æ£€æŸ¥æƒé™
const result = await mtpc.checkPermission({
  tenant: { id: 'tenant-001' },
  subject: { id: 'user-123', type: 'user' },
  resource: 'user',
  action: 'create',
})

console.log('æƒé™æ£€æŸ¥ç»“æœ:', result)
// { allowed: boolean, permission: string, reason: string, ... }
```

### æ­¥éª¤ 5ï¼šè¿è¡Œåº”ç”¨

```bash
npx tsx mtpc.ts
```

è¾“å‡ºï¼š

```
MTPC å·²åˆå§‹åŒ–
å·²æ³¨å†Œèµ„æº: ['user']
æƒé™æ£€æŸ¥ç»“æœ: { allowed: false, permission: 'user:create', reason: 'Permission not granted' }
```

## é›†æˆ RBAC

å¦‚æœä½ éœ€è¦åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶ï¼Œå¯ä»¥å®‰è£…å¹¶ä½¿ç”¨ `@mtpc/rbac`ï¼š

```bash
npm install @mtpc/rbac
```

```ts
import { createMTPC } from '@mtpc/core'
import { createRBACPlugin } from '@mtpc/rbac'

// åˆ›å»º RBAC æ’ä»¶
const rbacPlugin = createRBACPlugin()

// åˆ›å»º MTPC å®ä¾‹å¹¶é›†æˆ RBAC
const mtpc = createMTPC({
  defaultPermissionResolver: rbacPlugin.state.evaluator.getPermissions.bind(rbacPlugin.state.evaluator)
})

// æ³¨å†Œæ’ä»¶
mtpc.use(rbacPlugin)

// åˆå§‹åŒ–
await mtpc.init()
```

## ä¸‹ä¸€æ­¥

- ğŸ“– [æ¶æ„æ¦‚è§ˆ](/docs/architecture) - æ·±å…¥äº†è§£ MTPC çš„è®¾è®¡ç†å¿µå’Œæ¶æ„
- ğŸ“¦ [æ ¸å¿ƒåŒ…æ–‡æ¡£](/docs/packages) - äº†è§£ @mtpc/coreã€@mtpc/rbac ç­‰æ ¸å¿ƒåŒ…
- ğŸ“š [ç¤ºä¾‹æ•™ç¨‹](/docs/tutorials) - æŸ¥çœ‹å®Œæ•´çš„ç¤ºä¾‹é¡¹ç›®
- ğŸ”§ [å¼€å‘æŒ‡å—](/docs/guides) - èµ„æºå®šä¹‰ã€æƒé™è®¾è®¡ã€å¤šç§Ÿæˆ·å®ç°ç­‰

## ç¤ºä¾‹é¡¹ç›®

- [example-api](https://github.com/your-org/mtpc/tree/main/apps/example-api) - å®Œæ•´çš„ API ç¤ºä¾‹
- [example-web](https://github.com/your-org/mtpc/tree/main/apps/example-web) - å‰ç«¯é›†æˆç¤ºä¾‹

## å¸¸è§é—®é¢˜

### MTPC æ”¯æŒå“ªäº›æ•°æ®åº“ï¼Ÿ

MTPC Core æ˜¯æ•°æ®åº“æ— å…³çš„ã€‚é€šè¿‡é€‚é…å™¨å¯ä»¥æ”¯æŒå„ç§æ•°æ®åº“ï¼š

- [@mtpc/adapter-drizzle](/docs/packages/adapter-drizzle) - æ”¯æŒ PostgreSQLã€MySQLã€SQLite ç­‰
- ä½ ä¹Ÿå¯ä»¥å®ç°è‡ªå·±çš„é€‚é…å™¨

### MTPC æ”¯æŒå“ªäº›æ¡†æ¶ï¼Ÿ

MTPC æ˜¯æ¡†æ¶æ— å…³çš„ã€‚é€šè¿‡é€‚é…å™¨å¯ä»¥æ”¯æŒå„ç§ Web æ¡†æ¶ï¼š

- [@mtpc/adapter-hono](/docs/packages/adapter-hono) - Hono æ¡†æ¶
- ä½ ä¹Ÿå¯ä»¥å®ç°è‡ªå·±çš„é€‚é…å™¨

### å¦‚ä½•è·å–å¸®åŠ©ï¼Ÿ

- ğŸ“– æŸ¥çœ‹[æ•…éšœæ’é™¤æ–‡æ¡£](/docs/troubleshooting)
- ğŸ’¬ åŠ å…¥æˆ‘ä»¬çš„ [Discord ç¤¾åŒº](https://discord.gg/mtpc)
- ğŸ› æäº¤ [Issue](https://github.com/your-org/mtpc/issues)

---

**ç»§ç»­å­¦ä¹ ï¼š** [æ¶æ„æ¦‚è§ˆ](/docs/architecture) â†’
